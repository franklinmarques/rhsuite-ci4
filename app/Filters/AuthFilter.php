<?phpnamespace App\Filters;use App\Controllers\BaseController;use CodeIgniter\HTTP\RequestInterface;class AuthFilter extends BaseFilter{    public function before(RequestInterface $request, $arguments = null)    {        self::$controller = service('router')->handle();        $hasBaseController = get_parent_class(self::$controller) === BaseController::class;        if ($hasBaseController and is_null(session('logado'))) {            if ($request->isAJAX()) {                return service('response')->setStatusCode(401)->setJSON();            }            return redirect()->to(site_url('login'));        }    }}